<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1775097600']= array(base64_decode('aXNfc'.'3RyaW'.'5n'),base64_decode('c3Ry'.'d'.'G9sb'.'3d'.'lcg='.'='),base64_decode('a'.'XN'.'fY'.'XJyY'.'Xk='),base64_decode('aXNfc3RyaW'.'5n'),base64_decode('Z3pkZ'.'WNvZGU='),base64_decode('YmFzZT'.'Y0X2RlY2'.'9k'.'ZQ=='),base64_decode('dXJsZGV'.'jb2Rl'),base64_decode('YX'.'JyYXlfcmV2ZXJzZQ'.'='.'='),base64_decode('Z'.'3'.'plbmNvZGU='),base64_decode(''.'YmFz'.'ZTY0X'.'2V'.'u'.'Y29k'.'ZQ=='),base64_decode('dX'.'J'.'sZW5jb2Rl'),base64_decode('Yml'.'uMm'.'hleA'.'='.'='),base64_decode(''.'a'.'XNfY'.'X'.'Jy'.'YX'.'k='),base64_decode('c3RydG9s'.'b'.'3dl'.'cg=='),base64_decode('aXNfY'.'XJyYXk='),base64_decode('am9pbg=='),base64_decode('Zm5tYXRja'.'A=='),base64_decode('cmF3dX'.'J'.'sZGVjb'.'2Rl'),base64_decode('c3Vic'.'3Ry'),base64_decode(''.'c3V'.'ic3R'.'y'),base64_decode('c3RyX3JlcGx'.'hY2U'.'='),base64_decode('cHJlZ'.'19xdW90ZQ=='),base64_decode('cHJlZ1'.'9tY'.'X'.'R'.'ja'.'A'.'=='));if(!function_exists(__NAMESPACE__.'\\___232075864')){function ___232075864($_2004120500){static $_324561116= false; if($_324561116 == false) $_324561116=array(''.'Y'.'WN0'.'aW9u','aW5'.'0dmF'.'s','cGF0aA==','Y29u'.'dG'.'V4dA==','a2V5cw='.'=','cHJvY2Vzcw'.'==','Z'.'W'.'5jb'.'2Rpbmc=','c'.'HJl'.'Z19y'.'ZXBsY'.'WNl','cGF0aA==',''.'Y29udG'.'V4dA'.'==','a2'.'V5'.'cw==',''.'cH'.'Jv'.'Y'.'2Vzc'.'w==','Z'.'W'.'5j'.'b2'.'Rpbmc=','cGF0d'.'GVybg==','cHJlZ19'.'tY'.'XR'.'jaA==','cGF0a'.'A==',''.'Y29udGV'.'4dA'.'==','a'.'2'.'V5cw'.'==','cH'.'JvY'.'2Vzcw'.'==','Z'.'W5jb'.'2Rpbmc=','cG'.'F0dG'.'V'.'y'.'bg==','cG9'.'zdF'.'9hY3'.'Rpb'.'24=','Y2h'.'lY2tf'.'Y3'.'NyZg==',''.'cGF0aA==','Y2'.'9u'.'dGV4dA==',''.'a2V'.'5cw'.'==','cHJvY'.'2Vzcw==','ZW5'.'jb2Rpbm'.'c=',''.'cGF0'.'d'.'GVybg='.'=','YWN'.'0aW'.'9'.'u',''.'Y'.'W'.'N0aW'.'9u','YWN0aW9u','YWN0aW9u','YWN0'.'aW9u',''.'Y'.'WN0aW9'.'u',''.'cG9zd'.'F9hY3Rp'.'b24'.'=',''.'ZW5jb2Rpb'.'mc=',''.'ZW5'.'jb'.'2Rp'.'bm'.'c=','ZW'.'5'.'jb2Rpb'.'mc=','ZW'.'5jb2Rpbmc'.'=',''.'Z'.'W5jb2Rpbmc=','ZW5j'.'b2Rpbm'.'c'.'=','Z'.'3o=',''.'YmF'.'zZT'.'Y0','dXJs','a'.'GV4','Lg==',''.'L'.'w'.'==','aW5kZXgucGh'.'w','L'.'2lu'.'ZGV4LnB'.'ocA='.'=','U0NSSVB'.'UX05BT'.'UU=',''.'L2luZGV4L'.'nBoc'.'A'.'==','U0NSS'.'VBUX05BTUU=',''.'U0NSS'.'VBUX05'.'BTUU=','U'.'0N'.'S'.'SVBU'.'X05BTU'.'U=','fg==','f'.'l4'.'=','f'.'g==','XH'.'4=','JH4=');return base64_decode($_324561116[$_2004120500]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_310287575; protected $_1375820968; protected $_202434096; protected $_729746265; protected $_756648119; public static function make(array $_2123840586):?static{ $_2123840586= static::prepareRuleParameters($_2123840586); return match($_2123840586[___232075864(0)]){ ___232075864(1) => new IntvalRule( $_2123840586[___232075864(2)], $_2123840586[___232075864(3)], $_2123840586[___232075864(4)], $_2123840586[___232075864(5)], $_2123840586[___232075864(6)]), ___232075864(7) => new PregReplaceRule( $_2123840586[___232075864(8)], $_2123840586[___232075864(9)], $_2123840586[___232075864(10)], $_2123840586[___232075864(11)], $_2123840586[___232075864(12)], $_2123840586[___232075864(13)]), ___232075864(14) => new PregMatchRule( $_2123840586[___232075864(15)], $_2123840586[___232075864(16)], $_2123840586[___232075864(17)], $_2123840586[___232075864(18)], $_2123840586[___232075864(19)], $_2123840586[___232075864(20)], $_2123840586[___232075864(21)]), ___232075864(22) => new CsrfRule( $_2123840586[___232075864(23)], $_2123840586[___232075864(24)], $_2123840586[___232075864(25)], $_2123840586[___232075864(26)], $_2123840586[___232075864(27)], $_2123840586[___232075864(28)],), default => null,};} protected static function prepareRuleParameters(array $_1420421055): array{ if($GLOBALS['____1775097600'][0]($_1420421055[___232075864(29)])){ $_1420421055[___232075864(30)]= $GLOBALS['____1775097600'][1]($_1420421055[___232075864(31)]);} elseif($GLOBALS['____1775097600'][2]($_1420421055[___232075864(32)])){ $_281908317= $_1420421055[___232075864(33)]; $_1420421055[___232075864(34)]= $_281908317[(854-2*427)]; $_1420421055[___232075864(35)]= $_281908317[round(0+1)];} $_1420421055[___232075864(36)]=!empty($_1420421055[___232075864(37)])? $_1420421055[___232075864(38)]:[]; if($GLOBALS['____1775097600'][3]($_1420421055[___232075864(39)])){ $_1420421055[___232075864(40)]=[$_1420421055[___232075864(41)]];} return $_1420421055;}  public function __construct($_310287575, $_1375820968, $_202434096, $_729746265, $_756648119){ $this->_310287575= $_310287575; $this->_1375820968= $this->castContext($_1375820968); $this->_202434096= $this->castKeys($_202434096); $this->_729746265= $_729746265; $this->_756648119= $_756648119;} public function evaluateValue($_1358916949){ if(!empty($this->_756648119)){ foreach($this->_756648119 as $_198811320){ $_1358916949= match($_198811320){ 'gz' => $GLOBALS['____1775097600'][4]($_1358916949), 'base64' => $GLOBALS['____1775097600'][5]($_1358916949), 'url' => $GLOBALS['____1775097600'][6]($_1358916949), 'hex' => hex2bin($_1358916949)};}} $_1125489171= $this->evaluate($_1358916949); if(!empty($this->_756648119) && $_1125489171 instanceof ModifyResult){ $_1795483560= $_1125489171->getCleanValue(); foreach($GLOBALS['____1775097600'][7]($this->_756648119) as $_198811320){ $_1795483560= match($_198811320){ ___232075864(42) => $GLOBALS['____1775097600'][8]($_1795483560), ___232075864(43) => $GLOBALS['____1775097600'][9]($_1795483560), ___232075864(44) => $GLOBALS['____1775097600'][10]($_1795483560), ___232075864(45) => $GLOBALS['____1775097600'][11]($_1795483560)};} $_1125489171= new ModifyResult($_1795483560);} return $_1125489171;} abstract public function evaluate($_1358916949); protected function castContext($_1375820968){ if(!$GLOBALS['____1775097600'][12]($_1375820968)){ $_1375820968=[$_1375820968];} foreach($_1375820968 as $_2048125057 => $_215238238){ $_1375820968[$_2048125057]= $GLOBALS['____1775097600'][13]($_215238238);} return $_1375820968;} protected function castKeys($_202434096){ if(!$GLOBALS['____1775097600'][14]($_202434096)){ $_202434096=[$_202434096];} return $_202434096;} public function matchKey(array $_1113369018): bool{ $_1113369018= $GLOBALS['____1775097600'][15](___232075864(46), $_1113369018); foreach($this->_202434096 as $_1212491713){   if($GLOBALS['____1775097600'][16]($_1212491713, $_1113369018)){ return true;}} return false;}  public function matchPath($_144486748){ if($this->_310287575 === '*'){ return true;}  $_1395400141= new Uri($_144486748); $_297360700= $_1395400141->getPath(); $_297360700= $GLOBALS['____1775097600'][17]($_297360700);      if(str_ends_with($_297360700, ___232075864(47))){ $_297360700 .= ___232075864(48);} $_297360700= Path::normalize($_297360700);  $_1937065868[]= $_297360700; if(str_ends_with($_297360700, ___232075864(49))){ $_1937065868[]= $GLOBALS['____1775097600'][18]($_297360700,(792-2*396),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___232075864(50)], ___232075864(51))){ $_1937065868[]= $GLOBALS['____1775097600'][19]($_SERVER[___232075864(52)],(976-2*488),-round(0+9));} if($_297360700 !== $_SERVER[___232075864(53)]){ $_1937065868[]= $_SERVER[___232075864(54)];}  if(str_starts_with($this->_310287575, ___232075864(55))){ $_322581138= $this->_310287575;} else{ $_322581138= ___232075864(56). $GLOBALS['____1775097600'][20](___232075864(57), ___232075864(58), $GLOBALS['____1775097600'][21]($this->_310287575)). ___232075864(59);} foreach($_1937065868 as $_670367485){ if($this->_310287575 === $_670367485 || $GLOBALS['____1775097600'][22]($_322581138, $_670367485)){ return true;}} return false;}  public function getPath(){ return $this->_310287575;}  public function getContext(){ return $this->_1375820968;}  public function getKeys(){ return $this->_202434096;}  public function getProcess(){ return $this->_729746265;}}?>